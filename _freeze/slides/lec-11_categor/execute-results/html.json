{
  "hash": "74c589750c3a38e5a31124e4eae5e1d0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 11: Categorical Predictors & Logistic Regression\"\nsubtitle: \"Date: November 3, 2025\"\nfooter:  \"[course-website](https://dharaden.github.io/psyc640/)\"\nlogo: \"images/640_hex.png\"\nformat: \n  revealjs:\n    theme: clean.scss\n    multiplex: false\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\n    overview: false\n    scrollable: true\n    code-line-numbers: true\neditor: visual\nexecute:\n  echo: true\n  freeze: auto\n---\n\n## Today...\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rio)\nlibrary(here)\nlibrary(lm.beta)\nlibrary(easystats)\nlibrary(sjPlot)\n\n\n#Remove Scientific Notation \noptions(scipen=999)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Regression\n\n**3 main reasons for using regression:**\n\n1.  As a description (what is the average salary for men and women?)\n2.  As part of causal inference (Does being a woman result in a lower salary?)\n3.  For prediction (\"What happens if...\" questions)\n\n------------------------------------------------------------------------\n\n### Explaining Variance\n\n![](images/clipboard-3448148790.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n### Model Interpretation\n\nOnce we have a model, we will be able to interpret the coefficients. For a bivariate regression, this was fairly straightforward\n\nWe would look to the beta (effect size) and interpret it as: ***for every 1 unit increase in our X variable, there will be beta units increase in our Y variable.***\n\n------------------------------------------------------------------------\n\n## Multiple Regression\n\nWe may want to include additional predictors into our model to best explain the variance in an outcome:\n\n$$ Y_i = b_0 + b_1X_{1i} + b_2X_{2i} + ... + b_nX_{ni}+ e_i $$\n\n------------------------------------------------------------------------\n\n### Explaining Variance\n\n![](images/clipboard-4102854469.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n### Model Interpretation\n\nSince we have multiple predictors in the model, we have to interpret each predictor estimate while considering the other variables.\n\nWe would look to the beta (effect size) and interpret it as: ***for every 1 unit increase in our*** $X_1$ ***variable, there will be beta units increase in our Y (outcome) variable, [holding all other variables constant]{.underline}.***\n\n------------------------------------------------------------------------\n\n## Reporting Standardized or Unstandardized?\n\n**INTERPRET *b***:\n\n-   When the variables are measured in a meaningful metric\n\n-   To compare the relative effects of different predictors in the same sample\n\n**INTERPRET *Œ≤***:\n\n-   When the variables are not measured in a meaningful metric\n\n-   To compare effects across samples or studies\n\n------------------------------------------------------------------------\n\n## Multiple Regression: Example\n\nPreviously, we predicted the \\# of Transformers movies someone watched by their age, income and \\# of books read\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncah_data <- import(here(\"files\", \"data\", \n                        \"CAH.csv\")) %>% \n  mutate(across(where(is.character), ~na_if(., \"\")))\n```\n:::\n\n\nThe regression equation would look something like this:\n\n$$\nY = b_0 + b_1X_1 + b_2X_2 + b_3X_3 + e\n$$\n\n------------------------------------------------------------------------\n\n### Transformers Regression: $b$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreg1 <- lm(transformers ~ age + income + books,\n           data = cah_data)\n```\n:::\n\n\n**Interpret**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(reg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = transformers ~ age + income + books, data = cah_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.0283 -1.0658 -0.6646  0.8359  4.2314 \n\nCoefficients:\n                 Estimate    Std. Error t value             Pr(>|t|)    \n(Intercept)  2.6872892571  0.3197311424   8.405 0.000000000000000644 ***\nage         -0.0256880349  0.0054919383  -4.677 0.000003904370103857 ***\nincome      -0.0000021955  0.0000009953  -2.206               0.0279 *  \nbooks        0.0018608303  0.0009792731   1.900               0.0581 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.504 on 427 degrees of freedom\n  (569 observations deleted due to missingness)\nMultiple R-squared:  0.06449,\tAdjusted R-squared:  0.05791 \nF-statistic: 9.811 on 3 and 427 DF,  p-value: 0.000002857\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Transformers Regression: $\\beta$\n\n`scale()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreg1.std <- lm(scale(transformers) ~ scale(age) + scale(income) + scale(books),\n           data = cah_data)\n\nsummary(reg1.std)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = scale(transformers) ~ scale(age) + scale(income) + \n    scale(books), data = cah_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.3007 -0.6834 -0.4262  0.5361  2.7135 \n\nCoefficients:\n              Estimate Std. Error t value  Pr(>|t|)    \n(Intercept)   -0.04536    0.04817  -0.942    0.3469    \nscale(age)    -0.27392    0.05856  -4.677 0.0000039 ***\nscale(income) -0.10176    0.04613  -2.206    0.0279 *  \nscale(books)   0.09053    0.04764   1.900    0.0581 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9642 on 427 degrees of freedom\n  (569 observations deleted due to missingness)\nMultiple R-squared:  0.06449,\tAdjusted R-squared:  0.05791 \nF-statistic: 9.811 on 3 and 427 DF,  p-value: 0.000002857\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Transformers Regression: $\\beta$\n\n`lm.beta()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Same as before\nreg1 <- lm(transformers ~ age + income + books,\n           data = cah_data)\n\nbeta1.std <- lm.beta(reg1)\nsummary(beta1.std)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = transformers ~ age + income + books, data = cah_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.0283 -1.0658 -0.6646  0.8359  4.2314 \n\nCoefficients:\n                 Estimate  Standardized    Std. Error t value\n(Intercept)  2.6872892571            NA  0.3197311424   8.405\nage         -0.0256880349 -0.2194418839  0.0054919383  -4.677\nincome      -0.0000021955 -0.1036558341  0.0000009953  -2.206\nbooks        0.0018608303  0.0890938373  0.0009792731   1.900\n                        Pr(>|t|)    \n(Intercept) 0.000000000000000644 ***\nage         0.000003904370103857 ***\nincome                    0.0279 *  \nbooks                     0.0581 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.504 on 427 degrees of freedom\n  (569 observations deleted due to missingness)\nMultiple R-squared:  0.06449,\tAdjusted R-squared:  0.05791 \nF-statistic: 9.811 on 3 and 427 DF,  p-value: 0.000002857\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### How would we write up the results?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = transformers ~ age + income + books, data = cah_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.0283 -1.0658 -0.6646  0.8359  4.2314 \n\nCoefficients:\n                 Estimate  Standardized    Std. Error t value\n(Intercept)  2.6872892571            NA  0.3197311424   8.405\nage         -0.0256880349 -0.2194418839  0.0054919383  -4.677\nincome      -0.0000021955 -0.1036558341  0.0000009953  -2.206\nbooks        0.0018608303  0.0890938373  0.0009792731   1.900\n                        Pr(>|t|)    \n(Intercept) 0.000000000000000644 ***\nage         0.000003904370103857 ***\nincome                    0.0279 *  \nbooks                     0.0581 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.504 on 427 degrees of freedom\n  (569 observations deleted due to missingness)\nMultiple R-squared:  0.06449,\tAdjusted R-squared:  0.05791 \nF-statistic: 9.811 on 3 and 427 DF,  p-value: 0.000002857\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### How would we write up the results?\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntab_model(reg1, show.std = TRUE,\n          pred.labels = c(\"Intercept\", \"Age\", \n                          \"Income\", \"# of Books\"), \n          dv.labels = \"# of Transformers Movies\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"5\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \"># of Transformers Movies</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">std. Beta</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">standardized CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.06&nbsp;&ndash;&nbsp;3.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.09&nbsp;&ndash;&nbsp;0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.22</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.04&nbsp;&ndash;&nbsp;-0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.31&nbsp;&ndash;&nbsp;-0.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00&nbsp;&ndash;&nbsp;-0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.20&nbsp;&ndash;&nbsp;-0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.028</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \"># of Books</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00&nbsp;&ndash;&nbsp;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00&nbsp;&ndash;&nbsp;0.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.058</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"5\">431</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"5\">0.064 / 0.058</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n> A linear regression model was fit to the data to predict \\# of Transformers movies watched with participant age, income and reported \\# of books read. The model explains a significant, but small portion of variance in the outcome (*F(3, 427)* = 9.81, *p* \\< .001, adj. $R^2$ = .06). Participant age ( $\\beta$ = -0.22, *p* \\< .001) and income ( $\\beta$ = -0.10, *p* = .028) were significantly related to the number of transformers movies, while the number of books was not (*p* = .508). These findings suggest that as individuals age, they tend to watch fewer transformers movies, controlling for income and \\# of books. Additionally, as income increases, we see a decrease in \\# of transformer movies while taking into account participant age and \\# of books.\n\n# But what about categorical variables as predictors?\n\n![](images/clipboard-1169136778.jpeg){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## Categorical Predictors\n\nTypically identified by a grouping variable that may be a `character`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(cah_data$political_affiliation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n chr [1:1000] \"Democrat\" \"Democrat\" \"Independent\" \"Republican\" \"Democrat\" ...\n```\n\n\n:::\n:::\n\n\nNeed to change the variable from `character` to `factor` which will assign a number to each group\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncah_data <- cah_data %>%\n  mutate(\n    pol = as.factor(political_affiliation),\n    ghosts = as.factor(ghosts)\n    )\n\nglimpse(cah_data$pol)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Factor w/ 3 levels \"Democrat\",\"Independent\",..: 1 1 2 3 1 1 2 3 3 1 ...\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Categorical Data\n\n**Nominal** - the numbers have no relation to the category it represents (Biological Sex)\n\n-   *Biological Sex* - Male (1), Female (2), Intersex (3)\n\n**Ordinal** - the order of the numbers matters\n\n-   *Education Levels* - High school (1), Bachelor's (2), Master's (3), Doctorate (4)\n\n------------------------------------------------------------------------\n\n### Categorical Data - Regression\n\n***Can we use the numeric values that each category represents in a regression?*** I mean we can do just about anything. But, we should [**not**]{.underline} use the numeric values as they are\n\n**Why can't we do this?**\n\n::: callout-tip\nConsider how we interpret the beta coefficients for slope\n:::\n\n------------------------------------------------------------------------\n\n### Categorical Data - Regression\n\nRegressions assume that there are equal spacing between each of the values and that the spacing is meaningful\n\n-   Going from High School to Bachelor's is considered equal to Master's to Doctorate?\n\n-   What does it mean to interpret Male to Female to Intersex?\n\nTo properly investigate the differences between the groups, we have to \"trick\" our regression equation - *Enter Dummy Variables/Coding*\n\n------------------------------------------------------------------------\n\n## Dummy Coding\n\nNumerical placeholders used to represent categorical variables\n\nTaking a categorical variable with $k$ levels (e.g., `Democratic`, `Independent`, `Republican`) into $k-1$ binary variables.\n\n| political_affiliation | *becomes* | Ind (binary1) | Rep (binary2) |\n|-----------------------|-----------|---------------|---------------|\n| Democrat              | --\\>      | 0             | 0             |\n| Independent           | --\\>      | 1             | 0             |\n| Republican            | --\\>      | 0             | 1             |\n| ...                   |           | ...           | ...           |\n\n------------------------------------------------------------------------\n\n### Dummy Coding\n\nFor the variable with $k$ levels, we use $k-1$ binary variables...why not use all of them?\n\n::: incremental\n-   Including all three variables would result in perfect multicollinearity. All Democrats would be related to other Democrats and unrelated to everything else\n\n-   By including 2 binary variables, we are able to obtain all information about group membership\n:::\n\n------------------------------------------------------------------------\n\n### Dummy Coding\n\nThe group that has 0's for all the binary variables is the **reference group**\n\nFor interpretation, we will make our statements in reference to this group\n\n| political_affiliation | *becomes* | Ind (binary1) | Rep (binary2) |\n|-----------------------|-----------|---------------|---------------|\n| Democrat              | --\\>      | 0             | 0             |\n| Independent           | --\\>      | 1             | 0             |\n| Republican            | --\\>      | 0             | 1             |\n| ...                   |           | ...           | ...           |\n\n------------------------------------------------------------------------\n\n## Categorical Regression\n\nGoing back to our Transformers dataset, let's see how our political affiliation variable can predict \\# of transformers movies\n\nUsually you have to create the separate dummy variables, but not in R\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat1 <- lm(transformers ~ pol,\n           data = cah_data)\n```\n:::\n\n\nYou can also double check the dummy/contrast coding\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontrasts(cah_data$pol)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Independent Republican\nDemocrat              0          0\nIndependent           1          0\nRepublican            0          1\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Interpretation\n\nWe are shown the different levels of our predictor variable, but you will not see a predictor for the reference group\n\n::: callout-tip\nThink about how we interpret the intercept of a regression model. What are all values of our predictors set to be when looking at the intercept estimate?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(cat1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = transformers ~ pol, data = cah_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.3447 -1.1804 -0.3447  0.8196  3.8367 \n\nCoefficients:\n               Estimate Std. Error t value            Pr(>|t|)    \n(Intercept)     1.18039    0.09399  12.559 <0.0000000000000002 ***\npolIndependent  0.16434    0.12349   1.331               0.184    \npolRepublican  -0.01713    0.14257  -0.120               0.904    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.501 on 799 degrees of freedom\n  (198 observations deleted due to missingness)\nMultiple R-squared:  0.003244,\tAdjusted R-squared:  0.0007487 \nF-statistic:   1.3 on 2 and 799 DF,  p-value: 0.2731\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Refactor Reference Group\n\nMaybe we want to compare to a specific group\n\nWe need to then update the reference group\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncah_data$pol2 <- relevel(cah_data$pol, ref = \"Independent\")\ncat2 <- lm(transformers ~ pol2,\n           data = cah_data)\nsummary(cat2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = transformers ~ pol2, data = cah_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.3447 -1.1804 -0.3447  0.8196  3.8367 \n\nCoefficients:\n               Estimate Std. Error t value            Pr(>|t|)    \n(Intercept)     1.34473    0.08011  16.786 <0.0000000000000002 ***\npol2Democrat   -0.16434    0.12349  -1.331               0.184    \npol2Republican -0.18146    0.13383  -1.356               0.175    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.501 on 799 degrees of freedom\n  (198 observations deleted due to missingness)\nMultiple R-squared:  0.003244,\tAdjusted R-squared:  0.0007487 \nF-statistic:   1.3 on 2 and 799 DF,  p-value: 0.2731\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### `lm()` or `aov()`\n\nDidn't this look similar to something we've done before?\n\nWe are examining group differences in Transformer Movies (continuous) by Political Affiliation (group/categorical)\n\nIT IS JUST AN ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov1 <- aov(transformers ~ pol2,\n           data = cah_data)\nsummary(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value Pr(>F)\npol2          2    5.9   2.929     1.3  0.273\nResiduals   799 1799.8   2.252               \n198 observations deleted due to missingness\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Everything is a linear model\n\nWe are able to come to the same conclusions that there are no significant differences between groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Regression F-value\nsummary(cat2)$fstatistic[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.300092\n```\n\n\n:::\n\n```{.r .cell-code}\n# ANOVA F-value\nsummary(aov1)[[1]][1, 4]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.300092\n```\n\n\n:::\n:::\n\n\n# ![](images/clipboard-1177388101.webp)\n\n# Break ‚òïüçµü•ê\n\n# Activity Time üé®\n\n------------------------------------------------------------------------\n\n## Categories in Action\n\n**Goal:** Gain greater familiarity with dummy coding and categorical predictors\n\n**Scenario:** We are researchers examining the impact of a new intervention on reducing the vocalization \"6Ô∏è‚É£7Ô∏è‚É£\" in the youths. We have done classroom observations to collect data on how many times students say \"6Ô∏è‚É£7Ô∏è‚É£\" after receiving the intervention. This is the data you have in front of you. Youths have been randomly assigned to one of 3 groups, and we need to determine which had the biggest impact.\n\n::: callout-note\nYou will submit **one** Rmd file for the whole group. Be sure to include all group member's names.\n:::\n\n------------------------------------------------------------------------\n\n### Part 1\n\n1.  Get into groups of 4\n2.  Download the data <a href=\"/files/data/cat_reg.csv\" download=\"categorical_reg.csv\">\\[Download Categorical data (.csv)\\]</a>\n3.  Enter the data into the spreadsheet with the chips that you have\n    1.  Each chip has an ID number (three digits) and a score (between 5 - 20)\n    2.  These are the scores for the \"post\"\n    3.  Be sure to identify their Group (the color of the chip)\n\n------------------------------------------------------------------------\n\n### Part 2\n\n1.  Import the data into R\n\n    1.  You will only have data for one school (be sure to `filter()` to include your data)\n\n2.  On the board, put a portion of your data in a table along with your Dummy Code Scheme\n\n    1.  Dr. Haraden should have different sections designated, if not, please remind him nicely (he's doing his best)\n\n------------------------------------------------------------------------\n\n### Part 3\n\n1.  Calculate the average 6Ô∏è‚É£7Ô∏è‚É£ Score for your reference group:\\\n    Average Score for Group 1 (Reference) = \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_ = $\\beta_0$\n\n2.  Calculate the average 6Ô∏è‚É£7Ô∏è‚É£ Score for your other two groups:\\\n    Average Score for Group 2 = \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\\n    Average Score for Group 3 = \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\n\n3.  Calculate the \"Coefficients\" by finding the mean difference from the reference group:\\\n    $\\beta_1$ = (Avg. Group 2 Score) - (Avg. Group 1 Score) = \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\\n    $\\beta_2$ = (Avg. Group 3 Score) - (Avg. Group 1 Score) = \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\n\n------------------------------------------------------------------------\n\n### Part 4\n\nWrite out the regression equation for the model in which we are predicting 6Ô∏è‚É£7Ô∏è‚É£ Scores with our Dummy Variables. It should follow a format that we've used before ( $Y = b_0 + b_1X_1 + b_2X_2 + e$ ), but replacing your estimates in the correct places with the appropriate variables.\n\nOnce your group agrees on the equation, write it on the board for your group\n\n------------------------------------------------------------------------\n\n## Categories in Action: Using R\n\nNow that we have the data entered appropriately, let's double check, and include some additional variables!\n\nImport dataset, confirm predictions, include pre-scores to see how that changes interpretation\n\n::: callout-warning\nDr. Haraden is going to start opening up R and doing a follow-along thing. You have been warned\n:::\n\n# Everything is a linear model\n\n![](/images/reg_precious.gif)\n\n# Maybe another break?\n\n# Introducing Generalized Linear Model\n\n------------------------------------------------------------------------\n\n## 6Ô∏è‚É£7Ô∏è‚É£ Status\n\nIn our last example, we were able to see how these categorical variables could predict a continuous variable. This is perfect for linear regression.\n\n*What if we want to see if students have \"recovered\" from* 6Ô∏è‚É£7Ô∏è‚É£?\n\nWe would then ask: \"‚ÄúWhich participants dropped below the clinical threshold for 6Ô∏è‚É£7Ô∏è‚É£ at follow-up? Now, our outcome is either recovered or not recovered.‚Äù\n\n------------------------------------------------------------------------\n\n## Recovery Status\n\nNow we have a binary outcome; Yes/No recovery\n\nWhat happens when we fit a linear regression? What are the chances of someone with a pre-score of 12 recovering by the follow-up?\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncat_reg <- import(here(\"files\", \"data\", \n                       \"cat_reg_complete.xlsx\")) %>% \n  janitor::clean_names() %>% \n  # 1 = recovered; 0 = not recovered\n  mutate(recover = if_else(post_score > 12, 0, 1))\n\ncat_reg %>% \n  ggplot(aes(pre_score, recover)) +\n  geom_jitter(width = 0, height = 0.05, alpha = 0.5) + \n  geom_smooth(method = \"lm\", se = FALSE) + \n  labs(\n    title = \"Pre-Score predicting Recovery\"\n  )\n```\n\n::: {.cell-output-display}\n![](lec-11_categor_files/figure-revealjs/unnamed-chunk-17-1.png){width=960}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Probability to Odds to Log-Odds\n\n**Probability (*p*)**: The chance of an event happening. Ranges from 0 to 1\n\n**Odds**: The ratio of the probability of an event happening to it *not* happening.\n\n-   $Odds = \\frac{p}{1-p}$\n\n-   Ranges from 0 to ‚àû. An odds of 4 means the event is 4 times more likely to happen than not.\n\n**Log-Odds (logit)**: The natural log of the odds\n\n-   $Logit(p) = ln(\\frac{p}{1-p})$\n\n-   Ranges from -‚àû to +‚àû\n\n::: callout-important\nThis step transforms our bounded outcome variable (0/1) to an unbound one!\n:::\n\n------------------------------------------------------------------------\n\n## Generalized Linear Model (GLM)\n\nA generalization of a linear model (duh) that is used when the response variable has a non-normal error distribution\n\nMost commonly used when there is a binary (0-1) or count variable as the outcome (we will focus on the binary)\n\nUltimately, we are trying to identify the ***probability*** of the outcome taking the value 1 (\"success\") that is being modeled in relation to the predictor variables\n\n------------------------------------------------------------------------\n\n### GLM: Logistic Regression\n\n$$\ntransformation(p_i)=\\beta_0+\\beta_1x_{1,i} + \\beta_2x_{2,i} + \\cdots+\\beta_lx_{k,i}\n$$\n\nWe have to apply a transformation to the left side so that it can take variables beyond just 0 & 1\n\nA common transformation is the $logit\\ transformation$\n\n$$\n\\log_{e}\\left( \\frac{p_i}{1-p_i} \\right) = \\beta_0 + \\beta_1 x_{1,i} + \\beta_2 x_{2,i} + \\cdots + \\beta_k x_{k,i}\n$$\n\n------------------------------------------------------------------------\n\n### GLM - CAH data üëª\n\nResearch Question: *Does age, the number of books and the number of transformer movies predict the belief in ghosts?*\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Using glm() instead of lm()\nln1 <- glm(ghosts ~ books + age + transformers, \n           data = cah_data, \n           ## This is new\n           ##Tells the model we are doing logistic regression with a binary outcome\n           family = \"binomial\")\n```\n:::\n\n\n------------------------------------------------------------------------\n\n### GLM - CAH data Interpretation\n\n::: callout-note\nInterpretation is still the same as linear regression, ***except*** we are dealing with [**log-odds** of the outcome.]{.underline} What does that mean??\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(ln1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = ghosts ~ books + age + transformers, family = \"binomial\", \n    data = cah_data)\n\nCoefficients:\n               Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  -0.5175834  0.2466775  -2.098 0.035886 *  \nbooks         0.0008966  0.0009700   0.924 0.355311    \nage          -0.0046259  0.0044171  -1.047 0.294975    \ntransformers  0.1643321  0.0453671   3.622 0.000292 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1195.3  on 900  degrees of freedom\nResidual deviance: 1177.0  on 897  degrees of freedom\n  (99 observations deleted due to missingness)\nAIC: 1185\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### GLM - CAH data Interpretation (tables)\n\n::: callout-note\nWe want to be able to interpret these coefficients more easily so we put them into **Odds Ratios**\n:::\n\n`sjPlot` is always coming in with the good tables\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(ln1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">ghosts</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.60</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.37&nbsp;&ndash;&nbsp;0.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.036</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">books</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.00&nbsp;&ndash;&nbsp;1.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.355</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">age</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.99&nbsp;&ndash;&nbsp;1.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.295</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">transformers</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.08&nbsp;&ndash;&nbsp;1.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">901</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> Tjur</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.020</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Odds Ratios (OR)\n\n**OR \\> 1:** The predictor increases the odds of the outcome. (e.g., OR of 2.5 means the odds of believing in ghosts are 2.5 times higher).\n\n**OR \\< 1:** The predictor decreases the odds of the outcome. (e.g., OR of 0.4 means the odds of believing in ghosts are 60% lower).\n\n**OR = 1:** The predictor has no effect on the odds of the outcome.\n",
    "supporting": [
      "lec-11_categor_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}